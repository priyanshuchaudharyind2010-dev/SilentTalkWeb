<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Silent Talk</title>

<style>
*{box-sizing:border-box;font-family:Arial}
body{
margin:0;
background:#0f172a;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}
#login,#chat{
width:100%;
max-width:360px;
background:#020617;
color:white;
border-radius:12px;
padding:15px;
display:none;
}
input,button{
width:100%;
padding:10px;
margin-top:10px;
border-radius:8px;
border:none;
font-size:15px;
}
button{background:#22c55e;color:black;font-weight:bold}
#messages{
height:300px;
overflow-y:auto;
margin-top:10px;
}
.msg{
background:#1e293b;
padding:8px;
border-radius:8px;
margin-top:6px;
font-size:14px;
}
.self{background:#22c55e;color:black}
small{color:#94a3b8}
.online{color:#22c55e;font-size:12px}
.offline{color:#ef4444;font-size:12px}
</style>
</head>

<body>

<div id="login">
<h3>üîê Login</h3>
<input id="name" placeholder="Your name">
<input id="pass" type="password" placeholder="Password">
<button onclick="login()">Enter</button>
</div>

<div id="chat">
<h4>Silent Talk</h4>
<div id="status"></div>
<div id="messages"></div>
<input id="msg" placeholder="Type message">
<button onclick="send()">Send</button>
<button onclick="clearChat()" style="background:#ef4444;color:white">Delete Chat</button>
</div>

<script>
const PASSWORD="cutie29";
let user="";
let onlineUsers={};

document.getElementById("login").style.display="block";

function login(){
const n=document.getElementById("name").value.trim();
const p=document.getElementById("pass").value;
if(!n)return alert("Name likho");
if(p!==PASSWORD)return alert("Wrong password");
user=n;
document.getElementById("login").style.display="none";
document.getElementById("chat").style.display="block";
setOnline(true);
load();
}

function setOnline(state){
onlineUsers[user]=state;
localStorage.setItem("online",JSON.stringify(onlineUsers));
showStatus();
}

window.addEventListener("beforeunload",()=>setOnline(false));

function showStatus(){
let html="";
for(let u in onlineUsers){
html+=`<div class="${onlineUsers[u]?"online":"offline"}">
${u} : ${onlineUsers[u]?"online":"offline"}
</div>`;
}
document.getElementById("status").innerHTML=html;
}

function load(){
setInterval(()=>{
const data=JSON.parse(localStorage.getItem("chat")||"[]");
const box=document.getElementById("messages");
box.innerHTML="";
data.forEach(m=>{
box.innerHTML+=`<div class="msg ${m.u===user?"self":""}">
<b>${m.u}</b><br>${m.t}
</div>`;
});
box.scrollTop=box.scrollHeight;
onlineUsers=JSON.parse(localStorage.getItem("online")||"{}");
showStatus();
},500);
}

function send(){
const t=document.getElementById("msg").value.trim();
if(!t)return;
const data=JSON.parse(localStorage.getItem("chat")||"[]");
data.push({u:user,t});
localStorage.setItem("chat",JSON.stringify(data));
document.getElementById("msg").value="";
}

function clearChat(){
if(confirm("Delete all messages?")){
localStorage.removeItem("chat");
}
}
</script>

</body>
</html>
